<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Test</title>
    <script src="https://unpkg.com/@microsoft/teams-js@1.4.2/dist/MicrosoftTeams.min.js" integrity="sha384-DcoNUuQTjpW5Sw3msonn/2ojgtNvtC5fCGd5U9RUpL3g1hla1LzHz8I9YIYSXe6q" crossorigin="anonymous"></script>
    <script type="text/javascript">
        microsoftTeams.initialize();
        let taskInfo = {
        title: null,
        height: null,
        width: null,
        url: null,
        card: null,
        fallbackUrl: null,
        completionBotId: null,
            };
        function start() {

            document.getElementById("message").innerHTML += " test";
        }
        function taskMod() {
            taskInfo.url = "https://000abw.github.io/task.html";
            taskInfo.title = "Custom Form";
            taskInfo.height = 510;
            taskInfo.width = 430;
            submitHandler = (err, result) => {
                document.getElementById("message1").innerHTML += result.color;
                document.getElementById("message2").innerHTML += result.food;
                document.getElementById("message3").innerHTML += err;
            };
            microsoftTeams.tasks.startTask(taskInfo, submitHandler);
        }
        window.onload = start;

    </script>
</head>

<body>
    <h1>Hello world!</h1>
    <p>This is my test app for Teams. v2</p>
    <button onClick="taskMod()">Start Task Module</button>
    <div id="message1">Color: </div>
    <div id="message2">Food: </div>
    <div id="message2">Error: </div>
</body>
</html>
